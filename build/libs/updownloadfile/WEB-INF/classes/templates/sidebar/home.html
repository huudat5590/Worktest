<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<link rel="shortcut icon" type="image/x-icon" href="https://mwg.vn/wp-content/uploads/2014/05/favicon-1.ico" />

    <title>Upload App</title>

    <!-- Bootstrap CSS CDN -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
    <!-- Our Custom CSS -->
    <link rel="stylesheet" href="style2.css">
	
	
	<link rel="stylesheet" href="https://blueimp.github.io/Gallery/css/blueimp-gallery.min.css">
	<!-- CSS to style the file input field as button and adjust the Bootstrap progress bars -->
	<link rel="stylesheet" href="css/jquery.fileupload.css">
	<link rel="stylesheet" href="css/jquery.fileupload-ui.css">
	<!-- CSS adjustments for browsers with JavaScript disabled -->
	
	<noscript><link rel="stylesheet" href="css/jquery.fileupload-noscript.css"></noscript>
	<noscript><link rel="stylesheet" href="css/jquery.fileupload-ui-noscript.css"></noscript>
    <!-- Scrollbar Custom CSS -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.2/css/all.css" />
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
    <!-- Font Awesome JS -->
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/solid.js" integrity="sha384-tzzSw1/Vo+0N5UhStP3bvwWPq+uvzCMfrN1fEFe+xBmv1C/AtVX5K0uZtmcHitFZ" crossorigin="anonymous"></script>
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/fontawesome.js" integrity="sha384-6OIrr52G08NpOFSZdxxz1xdNSndlD4vdcf/q2myIUVO0VsqaGHJsB0RaBE01VTOY" crossorigin="anonymous"></script>
	<style>
		.disabled {
			pointer-events: none;
		}
		.filed {
    		font-size: 13px !important;
		}
	</style>

</head>

<body>
	<div id="text_loading"><p>Loading <img src="ajax-loader.gif" /> </p></div>
	<div class="header col-sm-12 " >
		<div class="container" style="margin: 0; max-width: 2422px;">
			<nav class="navbar navbar-expand-lg">
			  <a class="navbar-brand" href="home.html"><div class="logo"></div>
			  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			  </button>
			  <div class="collapse navbar-collapse" style="text-align : right" id="navbarNavAltMarkup">
				<div class="navbar-nav">
				  <a class="nav-item nav-link fab fa-android" href="#" style="font-size: 22px;" data-toggle="modal" data-target="#modalAndroid"></a>
				  <a class="nav-item nav-link fab fa-app-store" href="#" style="font-size: 22px;" data-toggle="modal" data-target="#modalIos"></a>
				  <a class="nav-item nav-link" data-toggle='modal' data-target='#myModal' onclick="newApp(-1)"  href="#">Tạo mới</a>
				  <a class="nav-item nav-link" href="admin.html" id="linkad" ><i  class="fas fa-user-circle" style="margin-right: 4px"></i> Quản trị</a>
				  <a class="nav-item nav-link" id="usershow" ><i class="fas fa-user-circle" style="margin-right: 4px"></i> </a>
				  <a class="nav-item nav-link" onclick="logout()"  ><i class="fas fa-sign-out-alt" style="margin-right: 4px"></i> </a>
				</div>
			  </div>
			</nav>
		</div>
		
	</div>
	<!-- <svg class="svg" width="100%" height="1500px" fill="none" id="wave">
		<path fill="white">
			<animate
					repeatCount="indefinite"
					fill="freeze"
					attributeName="d" dur="10s"
					values="
		M0 25.9086C277 84.5821 433 65.736 720 25.9086C934.818 -3.9019 1214.06 -5.23669 1442 8.06597C2079 45.2421 2208 63.5007 2560 25.9088V171.91L0 171.91V25.9086Z;
		M0 86.3149C316 86.315 444 159.155 884 51.1554C1324 -56.8446 1320.29 34.1214 1538 70.4063C1814 116.407 2156 188.408 2560 86.315V232.317L0 232.316V86.3149Z;
		M0 53.6584C158 11.0001 213 0 363 0C513 0 855.555 115.001 1154 115.001C1440 115.001 1626 -38.0004 2560 53.6585V199.66L0 199.66V53.6584Z;
		M0 25.9086C277 84.5821 433 65.736 720 25.9086C934.818 -3.9019 1214.06 -5.23669 1442 8.06597C2079 45.2421 2208 63.5007 2560 25.9088V171.91L0 171.91V25.9086Z">
			</animate>
		</path>
	</svg> -->
    <div class="col-sm-12 col-md-12" style="padding: 5% 0 5% 0%">
		<!-- Page Content  -->

		
		
        <div class="col allapp  justify-content-center" id="allApp" >
  
		</div>
		<div class="modal fade bd-example-modal-lg" tabindex="-1" id="myModal" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
			<div class="modal-dialog modal-lg">
			  <div class="modal-header" style="background : white ; width : 1000px; left : -110px;position : relative">
				  <h5 class="modal-title"><i class="fas fa-cloud-upload-alt"></i>   <span id="new"></span> </h5>
				  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				  </button>
			   </div>

			  <div class="modal-content">
				<div id="fileupload">
					  <!-- Redirect browsers with JavaScript disabled to the origin page -->
					  
					  <!-- The fileupload-buttonbar contains buttons to add/delete files and start/cancel the upload -->
					  <div class=" fileupload-buttonbar">

						  <div class="form-group col-sm-12">
								  <label for="usr">Tên App :</label>
								  <input type="text" class="form-control" id="AppName">
						  </div>
						  
						  <div class="form-group col-sm-12" id="OS" >
							<label for="usr">Chọn HĐH:</label>
							   <label id="type_os" >
								  <input type="radio" name="options" id="option1" onchange="ios()" autocomplete="off" checked> IOS
								</label>
								<label class="">
								  <input type="radio" name="options" onchange="android()" id="option2" autocomplete="off" > Andorid
								</label>
						  </div>

						  <div class="form-group col-sm-12" id="colOS">
							  <label for="usr">HĐH :</label>
							  <input type="text" class="form-control" readonly id="OSNameEdit">
						  </div>
						  
						  <div class="form-group col-sm-12 " style="padding: 0; display: flex">
							  <div class="col-sm-6" id="fileIcon">
									  <label for="exampleFormControlFile1">Chọn Icon</label>
									  <input accept="image/png, image/jpeg" type="file" class="form-control-file alert alert-primary" id="icon" name="icon">
							  </div>
							  <div class="col-sm-6" class="checkRomoveFileApp" id="fileAppIos">
									  <label class="" for="exampleFormControlFile1">Chọn File ipa</label>
									  <input accept=".ipa , .apk" type="file" class="form-control-file alert alert-primary"    id="fileios" name="fileios">
							  </div>

							  <div class="col-sm-6" class="checkRomoveFileApp" id="fileAppAndroid">
								  <label class="" for="exampleFormControlFile1">Chọn File apk</label>
								  <input accept=".ipa , .apk" type="file" class="form-control-file alert alert-primary" oninput="checkfile()"   id="fileandroid" name="fileandroid">
						  </div>
		  
						  </div>
						   
						  <div class="form-group col-sm-12 row"  id="plist">
							  <div class="col-sm-6" class="checkRomoveFileApp">
								  <label class="" for="exampleFormControlFile1">Chọn File PList</label>
								  <input accept=".plist" type="file" class="form-control-file alert alert-primary"  id="plistfile" onchange="ios()"    name="plistfile">
							  </div>				
						  </div>	  
						  
						  <div class="form-group col-sm-12" id="url_show" style="display : none">
							<label for="usr">URL CHPlay :</label>
							<input type="text" class="form-control" oninput="checktext()" id="new_path_anroid_chplay">
						   </div>
						  <div class="form-group">
							  <div class="col-sm-offset-12 col-sm-10">
								<button id="submit" onclick="submitPost()" name="btnSubmit " class="btn btn-success">Upload</button>
							  </div>
						   </div>

						   <div class="form-group">
							  <div class="col-sm-offset-12 col-sm-10">
								<a  id="err"></a>
							  </div>
						   </div>

					  </div>
					  <!-- The table listing the files available for upload/download -->
					  <table role="presentation" class="table table-striped"><tbody class="files"></tbody></table>
				  </div>
			  </div>
			</div>
		  </div>

		  <div class="modal fade bd-example-modal-lg" id="modalAndroid" tabindex="-1" role="dialog" aria-labelledby="modalAndroidTitle" aria-hidden="true">
			<div class="modal-dialog modal-dialog-centered" role="document">
			  <div class="modal-content" style="left: auto;">
				<div class="modal-header">
				  <h5 class="modal-title" id="exampleModalLongTitle1">Upload Android App </h5>
				  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				  </button>
				</div>
				<div class="modal-body row">
						<div class="form-group col-sm-12">
								<label for="usr">Tên App :</label>
								<input type="text" class="form-control" id="AppNameAdr" onchange="android()">
						</div>
						<div class="form-group col-sm-12" id="fileIconAdr">
								<label for="exampleFormControlFile1">Chọn Icon</label>
								<p class="filed"></p>
								<input accept="image/png, image/jpeg" type="file" class="form-control-file alert alert-primary" id="iconAdr" name="iconAdr">
						</div>
						<div class="form-group col-sm-12" id="fileAdrForm">
								<label class="" for="exampleFormControlFile1">Chọn File .apk Upload</label>
								<p class="filed"></p>
								<input accept=".ipa , .apk" type="file" class="form-control-file alert alert-primary" oninput="checkfile()"   id="fileAdr" name="fileAdr">
						</div>
						<div class="form-group col-sm-12" id="url_show_Adr">
								<label for="usr">URL CHPlay :</label>
								<input type="text" class="form-control" oninput="checktext()" id="new_path_anroid_chplay_Adr">
						</div>
						<div class="form-group col-sm-12" ><p id="errAndroidSingle"></p></div>
				</div>
				<div class="modal-footer">
				  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
				  <button type="button" class="btn btn-primary" onclick="post_android()">Upload</button>
				</div>
			  </div>
			</div>
		  </div>

		  <div class="modal fade bd-example-modal-lg" id="modalIos" tabindex="-1" role="dialog" aria-labelledby="modalIosTitle" aria-hidden="true">
				<div class="modal-dialog modal-dialog-centered" role="document">
				  <div class="modal-content" style="left: auto;">
					<div class="modal-header">
					  <h5 class="modal-title" id="exampleModalLongTitle2">Upload IOS App </h5>
					  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					  </button>
					</div>
					<div class="modal-body row">
							<div class="form-group col-sm-12">
									<label for="usr">Tên App :</label>
									<input type="text" class="form-control" id="AppNameIOS" onchange="ios()">
							</div>
							<div class="form-group col-sm-12" id="fileIconIOS">
									<label for="exampleFormControlFile1">Chọn Icon</label>
									<p class="filed"></p>
									<input accept="image/png, image/jpeg" type="file" class="form-control-file alert alert-primary" id="iconIOS" name="iconIOS">
							</div>
							<div class="form-group col-sm-12" id="fileIOSForm">
									<label class="" for="exampleFormControlFile1">Chọn File .ipa Upload</label>
									<p class="filed"></p>
									<input accept=".ipa , .apk" type="file" class="form-control-file alert alert-primary"    id="fileIOSSG" name="fileIOSSG">
							</div>
							<div class="form-group col-sm-12" id="plistForm">
									<label class="" for="exampleFormControlFile1">Chọn File .plist Upload</label>
									<p class="filed"></p>
									<input accept=".plist" type="file" class="form-control-file alert alert-primary"    id="filePlist" name="filePlist">
							</div>
							
							
							<div class="form-group col-sm-12" ><p id="errIOSSingle"></p></div>
					</div>
					<div class="modal-footer">
					  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
					  <button type="button" class="btn btn-primary" onclick="post_ios()">Upload</button>
					</div>
				  </div>
				</div>
				</div>
		
    </div>
	
	<script type="text/javascript">
	 	var host = window.location.host;
		var domain = (host == "localhost:8085" ? "http://172.16.61.226:8080" : "https://adminapp.tgdd.vn");
		var apiUrl = domain+'/file';
		var all_data = [];
		var files = [];
		var type_os = "ios";
		var Appid = -1;
		var token = localStorage.getItem('uploadAppFile');
		var own = localStorage.getItem('username');
		var url = "https://wsticket.tgdd.vn/user-service/api/user";
		var uploadedicon = false;
		var link_temp = "";
		
		function checkToken(){
			var data = {};
			var data_user = [];
			var err = true;
			
            
            var username = localStorage.getItem('username', username);
			
            if(username == null || token == null){
				window.location.href = "login.html";
			}
			else{
				let bodyAPI = {           
					"username": username,  
					"token"  : token       
				}
				      
				$(document).ready(function() {
					$.ajax({
							url: apiUrl+'/userdetail',
							data: JSON.stringify(bodyAPI),
							type: 'POST',
							processData: false,
							headers: {
								"Authorization": 'Bearer ' + token,
								"Content-Type": "application/json",        
							},
							success: function(success) {
								if(success != -1)
									document.getElementById("usershow").innerHTML ="Xin chào "+ success.object.lastName + success.object.firstName;	
							},
							error: function(fail) {
								console.log("Error", fail);	
								logout();
							}
						})
				
				});
			}
            
			  
		}
		checkToken();

		function logout(){
			localStorage.removeItem('username');
			localStorage.removeItem('uploadAppFile');
			window.location.href = "login.html";
		}
		var bodyGetAll = {
			'token' : token
		}
		function callAllList(){
			$( "#text_loading" ).css("display","block");
			$( "#text_loading" ).addClass( "loading" );
			$.ajax({
			url: apiUrl+"/alllistapp",
			data: bodyGetAll,
			type: 'GET',
			headers: {
				"Accept": "application/json",
				"Content-Type": "application/x-www-form-urlencoded"
			},
			success: function(success) {
				all_data = success;
				var count = 0;
				$( "#text_loading" ).removeClass( "loading" );
				$( "#text_loading" ).css("display","none");
				if(success.length != 0 ){	
					success.forEach(function(e,i){
						
						var path_ios = "" , path_android = "";
						if(e.own == own || own == '14511'){
							count++;							
						var urlImg = domain+'/updownloadfile/image'+e.iconpath;	
						if(e.path_ios != "" && e.path_ios != undefined)
							var path_ios = "<img class='hvr-wobble-vertical' src='https://app.tgdd.vn/img/mac-os.png' onclick='editApp("+e.id+','+'-2' + ")' data-toggle='modal' data-target='#modalIos' >";
						if(e.path_android_apk != "" && e.path_android_apk != undefined)
							var path_android = "<img class='hvr-wobble-vertical' src='https://app.tgdd.vn/img/google-play.png' onclick='editApp("+e.id+','+'-1' + ")' data-toggle='modal' data-target='#modalAndroid' >";				
						if( e.path_android_chplay != undefined && e.path_android_chplay != "")
							var path_android = "<img class='hvr-wobble-vertical' src='https://app.tgdd.vn/img/google-play.png' onclick='editApp("+e.id+','+'-1' + ")' data-toggle='modal' data-target='#modalAndroid' >";
						if(e.show)
						document.getElementById("allApp").innerHTML += "<div class='col-sm-5 col-md-4 col-xs-12 col-12  frame'><div style='height : 100px' class='top-frame'><img style='height : 90px' src='" + urlImg + "'  alt=''></div><p title='"+e.name+"' class=''>"+e.name+"</p>"+
						"<div class='bottom-frame'>"+path_android+path_ios
						}								
					})
					if($("#allApp img").length == 0)
						document.getElementById("allApp").innerHTML = "<h1 style='margin-top:15%'>Quyền truy cập app đã tạo hiện đang tạm khóa , vui lòng liên hệ 14511</h1>"
					
				}else {
					    document.getElementById("allApp").innerHTML = "<h1 style='margin-top:15%'>Bạn chưa tạo app nào , chọn tạo mới để khởi tạo</h1>"
				}
				
				if(count == 0){
						document.getElementById("allApp").innerHTML = "";
						document.getElementById("allApp").innerHTML = "<h1 style='margin-top:15%'>Bạn chưa tạo app nào , chọn tạo mới để khởi tạo</h1>"
				}
				
			},
			error: function(fail) {
				setTimeout(() => {
					$( "#text_loading" ).removeClass( "loading-small" );
					$( "#text_loading" ).css("display","none");		
				}, 200);
			}
		 }) 
		}
		
		callAllList();

		function android() {
			
			  var fileios = document.getElementById("fileios").files[0];
			  var plistfile = document.getElementById("plistfile").files[0];
			  var icon = document.getElementById("icon").files[0];
			  if(fileios !=undefined && plistfile != undefined && icon !=undefined){
		 	  document.getElementById("url_show").style.display = "block";
			  document.getElementById("plist").style.display = "none";
			  document.getElementById("fileAppAndroid").style.display = "block";
			  document.getElementById("fileAppIos").style.display = "none";
			  type_os = 'android';
			  $( "#err" ).text("");
			 
			  if(icon != undefined)
			  document.getElementById("fileIcon").style.display = "none";
			  else 
			  document.getElementById("fileIcon").style.display = "block";
			  }else{
				document.getElementById("option1").checked = true;
				document.getElementById("option2").checked = false;
				$( "#err" ).addClass("error");
				$( "#err" ).text("Bạn phải thêm đầy đủ mục ios trước");
			  }
			 
		};
		function ios() {
			
			  var fileios = document.getElementById("fileios").files[0];
			  var plistfile = document.getElementById("plistfile").files[0];
			  var icon = document.getElementById("icon").files[0];
			  
			  document.getElementById("url_show").style.display = "none";
			  document.getElementById("fileAppAndroid").style.display = "none";
			  document.getElementById("fileAppIos").style.display = "block";
			  type_os = 'ios';		  
			  if (Appid == -1) 
			  document.getElementById("plist").style.display = "block";
			  $( "#err" ).text("");
			  var icon = document.getElementById("icon").files[0];
			  if(icon != undefined)
			  document.getElementById("fileIcon").style.display = "block";
			  else 
			  document.getElementById("fileIcon").style.display = "block";					  
		};
		function checktext(e) {
		$(document).ready(function() {
		  tmpval = $('#new_path_anroid_chplay').val();
		  if (tmpval != '') {
			document.getElementById("fileAppAndroid").style.display = "none";
		  }else {
			document.getElementById("fileAppAndroid").style.display = "block";
		  }  
		  if ($('#new_path_anroid_chplay_Adr').val() != '') {			
			$("#fileAdrForm").addClass("disabled");
			$("#fileAdrForm .form-control-file").removeClass("alert alert-primary");
			$("#fileAdrForm .form-control-file").addClass("alert alert-secondary");
		  }else {
			$("#fileAdrForm").removeClass("disabled");
			$("#fileAdrForm .form-control-file").removeClass("alert alert-secondary");
			$("#fileAdrForm .form-control-file").addClass("alert alert-primary");
		  }  
		 
		});
		};
		function checkfile(e) {
		$(document).ready(function() {		 
		  if (document.getElementById("fileandroid").files.length == 1) {
			document.getElementById("url_show").style.display = "none";
		  }else {
			document.getElementById("url_show").style.display = "block";
		  }
	  
		  if (document.getElementById("fileAdr").files.length == 1) {
			
			$("#fileAdrForm label").css("color", "black");
			$("#new_path_anroid_chplay_Adr").addClass("disabled");
		  }else {
			$("#url_show_Adr").css("color", "black");
			
			$("#new_path_anroid_chplay_Adr").removeClass("disabled");
		  }    
	  
		});
		};

		
		function editApp(id,os){
			reset();
			all_data.forEach(function(e , i) {	
				if(id== e.id && id != -1){
					var typeimg = "";
					var typeimg = e.iconpath.split("/");
					Appid = e.id;					
					document.getElementById("OS").style.display = "none";
					document.getElementById("colOS").style.display = "block";
					if(os == -1){
						type_os = 'android';					
						document.getElementById("AppNameAdr").value = e.name;
						document.getElementById("OSNameEdit").value = "Android"
															
						if(e.path_android_apk == ""){
							document.getElementById("url_show").style.display = "block";
						}else{
							document.getElementById("url_show").style.display = "block";						
						}	
						document.getElementById("new_path_anroid_chplay_Adr").value = e.path_android_chplay;						
						link_temp = e.path_android_chplay;
						
						$("#fileIconAdr p").text(typeimg[3]);
						if(e.path_android_apk != "")
						$("#fileAdrForm p").text(e.name+'.apk');
						$("#AppNameAdr").attr("disabled",true);
					}
					else{
						type_os = 'ios';
						
						$("#fileIconIOS p").text(typeimg[3]);
						$("#plistForm p").text(e.name+'.plist');
						$("#fileIOSForm p").text(e.name+'.ipa');
						console.log(e.path_ios);
						
						$("#plistForm p").append("<span style='float: right'><a href='"+domain+e.path_ios+"' id='w3s'  target='_blank'>Download .plist file <i class='fa fa-download'></i></a></span>");
						document.getElementById("AppNameIOS").value = e.name;
						document.getElementById("OSNameEdit").value = "IOS";
						document.getElementById("url_show").style.display = "none";
						document.getElementById("fileAppAndroid").style.display = "none";
						document.getElementById("fileAppIos").style.display = "block";
						document.getElementById("plist").style.display = "block";	
						link_temp = e.path_android_chplay;
						$("#AppNameIOS").attr("disabled",true);					

					}

				}
				
			})
			document.getElementById("new").innerHTML = "";
			document.getElementById("new").innerHTML +='Cập nhật upload app';
		}
		function newApp(id){
			Appid = -1;
			document.getElementById("new").innerHTML = "";
			document.getElementById("new").innerHTML +='Upload App mới';
			document.getElementById("OS").style.display = "block";
			document.getElementById("fileAppAndroid").style.display = "none";
			document.getElementById("fileAppIos").style.display = "block";
			document.getElementById("url_show").style.display = "none";
			document.getElementById("colOS").style.display = "none";
			document.getElementById("plist").style.display = "block";
			reset();
		}
		function removeFile() {
			if(document.getElementById("fileandroid") != null && document.getElementById("fileios") != null && document.getElementById("plistfile") != null){
				document.getElementById("fileandroid").value = "";
			    document.getElementById("fileios").value = "";
				document.getElementById("plistfile").value = "";
				document.getElementById("iconAdr").value = "";
				document.getElementById("fileAdr").value = "";
				document.getElementById("new_path_anroid_chplay_Adr").value = "";
				document.getElementById("fileIOSSG").value = "";
				document.getElementById("filePlist").value = "";
				document.getElementById("AppNameAdr").value = "";
				document.getElementById("AppNameIOS").value = "";


			}
			   
		};
		function removeIcon() {
		 	  document.getElementById("icon").value = "";
		};
		function reset(){
			removeFile();
			removeIcon();
			document.getElementById("AppName").value = "";
			document.getElementById("new_path_anroid_chplay").value = "";
			document.getElementById("colOS").style.display = "none";
			link_temp = "";
			$( "#errIOSSingle" ).text("");
			$( "#errIOSSingle" ).text( "" );
			$( "#errAndroidSingle" ).removeClass( "error" );
			$( "#errIOSSingle" ).removeClass( "error" );
			$("exampleModalLongTitle1").text("Upload Android App");
			$("exampleModalLongTitle2").text("Upload IOS App");
			$("#AppNameIOS").attr("disabled",false);				
			$("#AppNameAdr").attr("disabled",false);				
			$( "#err" ).text( "");
			$("#option1").prop('checked', true);
			$("#fileIconAdr p").text("");
			$("#fileAdrForm p").text("");
			$("#fileIconIOS p").text("");
			$("#plistForm p").text("");
			$("#fileIOSForm p").text("");
			ios();
			type_os = 'ios'
			Appid = -1;
		}

		$('#modalAndroid').on('hidden.bs.modal', function (e) {
			reset();
		})
		$('#modalIos').on('hidden.bs.modal', function (e) {
			reset();
		})
		$('#myModal').on('hidden.bs.modal', function (e) {
			reset();
		})
		
		function submitPost(){
			var data = {};
			var checkValidate = false;
			var err = true;
			
			$(document).ready(function() {


				  var AppName = document.getElementById("AppName").value;
				  var icon = document.getElementById("icon").files[0];
				  var fileandroid = document.getElementById("fileandroid").files[0];
				  var fileios = document.getElementById("fileios").files[0];
				  var plistfile = document.getElementById("plistfile").files[0];
				  var url = document.getElementById("new_path_anroid_chplay").value;
				  var new_path_anroid_chplay = document.getElementById("new_path_anroid_chplay").value;
				  var formData = new FormData()
				  formData.append('Appid', Appid);
				  formData.append('AppName', AppName);
				  formData.append('osfile', type_os);
				  formData.append('token', token);
				  formData.append('newpath_android_chplay', new_path_anroid_chplay);
				  if(Appid == -1){
					if(AppName == ""){
						checkValidate = true;
						$( "#err" ).text( "Tên App không được để trống");
				  	}else if(icon == undefined){						  
						checkValidate = true;
						$( "#err" ).text( "Bạn phải chọn icon để upload");
					}
					else if(type_os == 'android'){
						if(url == ""){
							if(fileandroid == undefined){
								checkValidate = true;
								$( "#err" ).text( "Bạn phải chọn file apk để upload");
							}else{
								if(fileandroid.type != "application/vnd.android.package-archive"){
									checkValidate = true;
									$( "#err" ).text( "Chỉ được chọn loại file .apk");
									setTimeout(() => {
											$( "#err" ).text("");
									}, 3000);
								}else{
									if(fileios== undefined){
										checkValidate = true;									
										$("#option1").prop('checked', true);
										ios();
										$("#err").text( "Bạn phải chọn thêm file ipa để upload mới");
										setTimeout(() => {
											$( "#err" ).text("");
									},  3000);
									}
								}
								
							}							
							
						}else{
							var f = new File([""], "filename");
							formData.append('file', f);							
						}
					}else if(type_os == 'ios'){
						
						if(plistfile == undefined){
								checkValidate = true;
								$( "#err" ).text( "Bạn phải chọn file plist để upload");

						}else{
							if(fileios == undefined){
								checkValidate = true;
								$( "#err" ).text( "Bạn phải chọn thêm file ipa để upload mới");
							}else{
								if(fileandroid == undefined){
									checkValidate = true;
									$("#option2").prop('checked', true);
									android();
									$( "#err" ).text( "Bạn phải chọn thêm file apk để upload mới");
									setTimeout(() => {
										$( "#err" ).text("");
									}, 3000);
								}
							}
						}						
					}else{
							checkValidate = false;
					} 
					formData.append('plist', plistfile);	
					formData.append('own', own);
				  }else{
					if(AppName == ""){
							checkValidate = true;
							$( "#err" ).text( "Tên App không được để trống");

				  	}else if(type_os == 'android' || type_os == 'ios'){
									var f = new File([""], "filename");		
									if(icon == undefined)				
										icon = f;
									if(fileandroid == undefined){
										fileandroid = f;
									}
									if(fileios == undefined){
										fileios = f;
									}
									
					}else if(plistfile == undefined){		
									var z = new File([""], "plistfile");
									//plistfile = z;				
									if(icon == undefined){
										icon = z;
									}
					}
					else{
						checkValidate = false;
								
					}
					if(type_os == "android" && fileandroid.size != 0 && fileandroid.type != "application/vnd.android.package-archive"){
									checkValidate = true;
									$( "#err" ).text( "Chỉ được chọn loại file .apk");
					}
					
					
					var z = new File([""], "plistfile");
					if(plistfile == undefined){
						plistfile = z
					}
					formData.append('plist', plistfile);

				  }
				  formData.append('icon', icon);	
				  
				 
				  $( "#err" ).addClass( "error" );
				  if(Appid ==-1 && !checkValidate){
						
						var formData1 = new FormData();
						formData1.append('Appid', -1);
						formData1.append('token', token);
						formData1.append('newpath_android_chplay', '');
						formData1.append('file', fileios);																	
						formData1.append('osfile','ios');
						formData1.append('icon', icon);																		
						formData1.append('plist', plistfile);	
						var TempName1 = [];
						var TempName2 = "";
						TempName1 = AppName.split(" ");						
						TempName1.forEach((element , i) => {
							if(TempName1[i] != "")
							TempName2 = TempName2+TempName1[i];
						});		
										
						formData1.set('AppName', TempName2);
						
						   $( "#text_loading" ).css("display","block");
						   $( "#text_loading" ).text("Uploading");
						   $( "#text_loading" ).addClass( "loading" );
										$.ajax({
											url: apiUrl+'/upload',
											data: formData1,
											type: 'POST',
											headers: {},
											contentType: false,
											processData: false,
											success: function(success) {
														console.log(success)
														if(success != -1){				
																$( "#err" ).text( "");
																	
																	var z = new File([""], "plistfile");
																	var formData2 = new FormData();
																	formData2.append('Appid', success);
																	formData2.append('AppName', TempName2);
																	formData2.append('token', token);
																	formData2.append('newpath_android_chplay', new_path_anroid_chplay);
																	if(new_path_anroid_chplay != ""){
																		var zx = new File([""], "fileandroid");
																		formData2.append('file', zx);	
																		console.log(zx)		
																	}
																	else{
																		formData2.append('file', fileandroid);
																	}
																																		
																	formData2.append('osfile', 'android');
																	formData2.append('icon', icon);																		
																	formData2.append('plist', z);	
																	
																	$.ajax({
																				url: apiUrl+'/upload',
																				data: formData2,
																				type: 'POST',
																				headers: {},
																				contentType: false,
																				processData: false,
																				success: function(success2) {
																					if(success2 == -2){			
																						console.log("in case 2");
																							
																						$( "#err" ).text( "");
																						$( "#err" ).removeClass( "error" );
																						$( "#err" ).text( "Upload App thành công");
																							
																						setTimeout(() => {	
																							$( "#err" ).addClass( "success" );
																							$( "#text_loading" ).removeClass( "loading" );
																							$( "#text_loading" ).css("display","none");
																							$( "#text_loading" ).text("Loading");														
																							window.location.href = "home.html"
																							
																						}, 1500);
																						
																					}else{
																						$( "#err" ).text( "");
																						$( "#err" ).text( "Lỗi server");
																						setTimeout(() => {	
																							$( "#text_loading" ).removeClass( "loading" );
																							$( "#text_loading" ).css("display","none");																																											
																						}, 1500);		
																					}
																				},
																				error: function(fail) {						
																					
																				}
																		})
									
																	}else{
																		$( "#err" ).text( "");
																		$( "#err" ).text( "Lỗi server");
																		setTimeout(() => {	
																			$( "#text_loading" ).removeClass( "loading" );
																			$( "#text_loading" ).css("display","none");		
																			$( "#text_loading" ).text("Loading");																		
																		}, 1500);		
																	}
											},
											error: function(fail) {						
												
							}
						})
					}else if(Appid != -1 && !checkValidate){
						if(type_os == 'android')
						formData.append('file', fileandroid);
						else
						formData.append('file', fileios);
						var TempName1 = [];
						var TempName2 = "";
						TempName1 = AppName.split(" ");						
						TempName1.forEach((element , i) => {
							if(TempName1[i] != "")
							TempName2 = TempName2+TempName1[i];
						});						
						formData.set('AppName', TempName2);

						$( "#text_loading" ).css("display","block");
						$( "#text_loading" ).text("Uploading");	
				   		$( "#text_loading" ).addClass( "loading" );
										$.ajax({
											url: apiUrl+'/upload',
											data: formData,
											type: 'POST',
											headers: {},
											contentType: false,
											processData: false,
											success: function(success) {
														console.log(success)
														if(success == -2){				
															$( "#err" ).text( "");
															$( "#err" ).removeClass( "error" );
															$( "#err" ).text( "Upload App thành công");
																
															setTimeout(() => {	
																$( "#err" ).addClass( "success" );
																$( "#text_loading" ).removeClass( "loading" );
																$( "#text_loading" ).css("display","none");
																$( "#text_loading" ).text("Loading");	

																window.location.href = "home.html"
																		
																}, 1500);
											
														}else{
															$( "#err" ).text( "");
															$( "#err" ).text( "Lỗi server");
															setTimeout(() => {	
																$( "#text_loading" ).removeClass( "loading" );
																$( "#text_loading" ).css("display","none");
																$( "#text_loading" ).text("Loading");																					
															}, 1500);		
														}
											},
											error: function(fail) {						
												
							}
						})
					}		
				});			
		}

		function post_android() {
			
			var AppName = document.getElementById("AppNameAdr").value;
			var icon = document.getElementById("iconAdr").files[0];
			var fileandroid = document.getElementById("fileAdr").files[0];						
			var new_path_anroid_chplay = document.getElementById("new_path_anroid_chplay_Adr").value;
			var zx = new File([""], "fileplst");
			$( "#errAndroidSingle" ).addClass( "error" );
			$("exampleModalLongTitle1").text("");
			$("exampleModalLongTitle1").text("Edit Android App");
				
			if(Appid == -1){
				if(AppName == ''){
					$( "#errAndroidSingle" ).text( "Tên app không được để trống");
					return;
				}else if(fileandroid == undefined && new_path_anroid_chplay == ""){
					$( "#errAndroidSingle" ).text( "Chọn file .apk hoặc url để upload");
					return;
				}else if(icon == undefined){
					$( "#errAndroidSingle" ).text( "Chọn icon để upload");
					return;
				}
				else if(fileandroid != undefined && fileandroid.type != "application/vnd.android.package-archive"){								
					$("#errAndroidSingle").text( "Chỉ được chọn loại file .apk");
					setTimeout(() => {
							$("#errAndroidSingle").text("");
					}, 3000);
					return;
				}else if(fileandroid == undefined && new_path_anroid_chplay != "") {
							var fileandroid = zx;
				}
				
			}else {
				if(new_path_anroid_chplay == "")
				new_path_anroid_chplay = link_temp;
				if(fileandroid != undefined && fileandroid.type != "application/vnd.android.package-archive"){								
					$("#errAndroidSingle").text( "Chỉ được chọn loại file .apk");
					setTimeout(() => {
							$("#errAndroidSingle").text("");
					}, 3000);
					return;
				}
				if(icon == undefined)
					var icon = zx;
				if(fileandroid == undefined)
					var fileandroid = zx;
			}
							
			var TempName1 = [];
			var TempName2 = "";
			TempName1 = AppName.split(" ");						
			TempName1.forEach((element , i) => {
				if(TempName1[i] != "")
				TempName2 = TempName2+TempName1[i];
			});	
			var formDataAdnroid = new FormData();
			formDataAdnroid.append('AppName', TempName2);
			formDataAdnroid.append('Appid', Appid);
			formDataAdnroid.append('token', token);
			formDataAdnroid.append('newpath_android_chplay', new_path_anroid_chplay);
			formDataAdnroid.append('file', fileandroid);																	
			formDataAdnroid.append('osfile','android');
			formDataAdnroid.append('icon', icon);		
			formDataAdnroid.append('plist', zx);																	
							$( "#text_loading" ).css("display","block");
						    $( "#text_loading" ).addClass( "loading" );
						    $( "#text_loading" ).text("Uploading");	
										$.ajax({
											url: apiUrl+'/upload',
											data: formDataAdnroid,
											type: 'POST',
											headers: {},
											contentType: false,
											processData: false,
											success: function(success) {
														console.log(success)
														if(success != -1){				
															$( "#errAndroidSingle" ).text("");
															$( "#errAndroidSingle" ).removeClass( "error" );
															$( "#errAndroidSingle" ).addClass( "success" );
															$( "#errAndroidSingle" ).text( "Upload App thành công");
																
															setTimeout(() => {	
																
																$( "#text_loading" ).removeClass( "loading" );
																$( "#text_loading" ).css("display","none");	
																$( "#text_loading" ).text("Loading");		
																window.location.href = "home.html"
																		
																}, 2000);
											
														}else{
															$( "#errAndroidSingle" ).text( "");
															$( "#errAndroidSingle" ).text( "Lỗi server");
															setTimeout(() => {	
																$( "#text_loading" ).removeClass( "loading" );
																$( "#text_loading" ).css("display","none");
																$( "#text_loading" ).text("Loading");	
															}, 1500);		
														}
											},
											error: function(fail) {						
												
							}
						})
		}

		function post_ios() {
			
			var AppName = document.getElementById("AppNameIOS").value;
			var icon = document.getElementById("iconIOS").files[0];
			var plist = document.getElementById("filePlist").files[0];
			var fileios = document.getElementById("fileIOSSG").files[0];			
			var new_path_anroid_chplay = link_temp;
			
			$("exampleModalLongTitle2").text("");
			$("exampleModalLongTitle2").text("Edit IOS App");
			var zx = new File([""], "fileplst");
			$( "#errIOSSingle" ).addClass( "error" );
			
			if(Appid == -1){
				if(AppName == ''){
				$( "#errIOSSingle" ).text( "Tên app không được để trống");
				return;
				}else if(fileios == undefined){
					$( "#errIOSSingle" ).text( "Chọn file .ipa để upload");
					return;
				}else if(icon == undefined){
					$( "#errIOSSingle" ).text( "Chọn icon để upload");
					return;
				}else if(plist == undefined){
					$( "#errIOSSingle" ).text( "Chọn file .plist để upload");
					return;
				}
			}else{
				if(icon == undefined)
					var icon = zx;
				if(plist == undefined)
					var plist = zx;
				if(fileios == undefined)
					var fileios = zx;
			}
			
			var TempName1 = [];
			var TempName2 = "";
			TempName1 = AppName.split(" ");						
			TempName1.forEach((element , i) => {
				if(TempName1[i] != "")
				TempName2 = TempName2+TempName1[i];
			});		
																		
			var formDataAdnroid = new FormData();
			formDataAdnroid.append('AppName', TempName2);
			formDataAdnroid.append('Appid', Appid);
			formDataAdnroid.append('token', token);
			formDataAdnroid.append('newpath_android_chplay', new_path_anroid_chplay);
			formDataAdnroid.append('file', fileios);																	
			formDataAdnroid.append('osfile','ios');
			formDataAdnroid.append('icon', icon);		
			formDataAdnroid.append('plist', plist);																	
							$( "#text_loading" ).css("display","block");
						    $( "#text_loading" ).addClass( "loading" );
						    $( "#text_loading" ).text("Uploading");	
										$.ajax({
											url: apiUrl+'/upload',
											data: formDataAdnroid,
											type: 'POST',
											headers: {},
											contentType: false,
											processData: false,
											success: function(success) {
														console.log(success)
														if(success != -1){				
															$( "#errIOSSingle" ).text("");
															$( "#errIOSSingle" ).removeClass( "error" );
															$( "#errIOSSingle" ).addClass( "success" );
															$( "#errIOSSingle" ).text( "Upload App thành công");
																
															setTimeout(() => {	
																
																$( "#text_loading" ).removeClass( "loading" );
																$( "#text_loading" ).css("display","none");	
																$( "#text_loading" ).text("Loading");		
																window.location.href = "home.html"
																		
																}, 2000);
											
														}else{
															$( "#errIOSSingle" ).text( "");
															$( "#errIOSSingle" ).text( "Lỗi server");
															setTimeout(() => {	
																$( "#text_loading" ).removeClass( "loading" );
																$( "#text_loading" ).css("display","none");
																$( "#text_loading" ).text("Loading");	
															}, 1500);		
														}
											},
											error: function(fail) {						
												
							}
						})
		}

		function setTimeoutLogout(){
			setTimeout(() => {
				logout();
			}, 600000);
		}
		setTimeoutLogout();
		
	</script>
	
<!-- The template to display files available for download -->

</body>

</html>